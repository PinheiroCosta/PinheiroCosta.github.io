<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Blog">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Rastrear mensagens de erro no Bash </title>
    <link rel="apple-touch-icon" sizes="57x57" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;apple-icon-180x180.png">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" sizes="192x192"  href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="description" itemprop="about" content="">
    <meta name="keywords" itemprop="keywords" content="">
    <meta itemprop="headline" content=""/>
    <meta itemprop="educationalUse" content="knowledge share" />
    <meta itemprop="copyrightYear" content="2021" />
    <meta property="og:title" content=" Rastrear mensagens de erro no Bash ">
    <meta property="og:description" content=" Relata como descobriu o comando bash -x e explica como ele pode ser útil. ">
    <meta property="og:image" content="https:&#x2F;&#x2F;user-images.githubusercontent.com&#x2F;37278803&#x2F;112825055-adf9f880-9061-11eb-9b5c-6542bf4040ce.png">
    <meta property="og:url" content="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;rastrear-erro-no-terminal&#x2F;">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:site_name" content="PinheiroCosta">
    <meta name="twitter:image:alt" content="Rastrear mensagens de erro no Bash">

    <meta property="fb:app_id" content="???" />
    <meta name="twitter:site" content="@???">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600|Source+Code+Pro">
    <link rel="stylesheet" href="/site.css">
</head>

<body>
    <div 
     itemscope itemtype="http://schema.org/Organization">
    </div>

    <header class="header">
        <div class="container">
            <a class="title" href="http:&#x2F;&#x2F;127.0.0.1:1111&#x2F;">
                    <img src="https:&#x2F;&#x2F;user-images.githubusercontent.com&#x2F;37278803&#x2F;112825055-adf9f880-9061-11eb-9b5c-6542bf4040ce.png" alt="">
                    <h1 >PinheiroCosta</h1>
            </a>
        </div>
    </header>

    <div class="container padding-header">
        
<article itemscope itemtype="http://schema.org/BlogPosting" class="post post-page">
    
        
            <meta itemprop="image" content="https:&#x2F;&#x2F;user-images.githubusercontent.com&#x2F;37278803&#x2F;112825055-adf9f880-9061-11eb-9b5c-6542bf4040ce.png">
        
    
    <header>
        
        <h1 class="title" itemprop="headline">Rastrear mensagens de erro no Bash</h1>
        <address itemprop="author" itemscope itemtype="https://schema.org/Person">
            <span itemprop="name">Rômulo Pinheiro</span>
        </address>
        <div class="extra">
            

            
        </div>
    </header>
    <div itemprop="articleBody" class="body">
      <p>Estou na linha de comando quando me deparo com uma mensagem de erro. Mas infelizmente não existe referência para o arquivo de origem nesta mensagem. E o que encontrei na internet foram artigos bem genéricos sobre o problema, e agora? Neste artigo compartilho alguns comandos que utilizei pra resolver este impasse. Segue abaixo a mensagem:</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">bash:</span><span style="color:#c0c5ce;"> eval: linha 335: encontrado EOF inesperado enquanto procurava por `&#39;&#39; correspondente
</span><span style="color:#bf616a;">bash:</span><span style="color:#c0c5ce;"> eval: linha 336: erro de sintaxe: fim prematuro do arquivo
</span></code></pre>
<p>Aqui observamos que o problema se encontra entre a linha 335 e 336 de algum arquivo. Trata-se de um erro de sintaxe, e o script em questão não foi executado até o fim como descrito acima.</p>
<p>Mas para compreender melhor do que se trata, é necessário ficar atento no contexto. O que eu estava fazendo no momento que a mensagem surgiu? Bom. esta mensagem surge todas as vezes que eu abro o terminal. Isso significa que está relacionada com algum arquivo que é executado na inicialização do terminal? Vamos descobrir.</p>
<p>O arquivo <em>.bashrc</em> é o responsável por executar as configurações que serão inicializadas com o terminal.Ele fica localizado na pasta <em>/home/usuário/</em>. Porém no meu caso, este arquivo não chega a ter nem 300 linhas. E podemos observar isso com o seguinte comando:</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> wc</span><span style="color:#bf616a;"> -l</span><span style="color:#c0c5ce;"> /home/usuario/.bashrc
</span><span style="color:#bf616a;">80</span><span style="color:#c0c5ce;"> .bashrc
</span></code></pre>
<p>Ocorre que este arquivo importa configurações de outros arquivos. com o comando <em>source</em>. Vamos descobrir que arquivos são estes.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> cat .bashrc | </span><span style="color:#bf616a;">grep </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">source</span><span style="color:#c0c5ce;">&quot;
</span><span style="color:#96b5b4;">source </span><span style="color:#c0c5ce;">&quot;$</span><span style="color:#bf616a;">BASH_IT</span><span style="color:#c0c5ce;">&quot;/bash_it.sh
</span><span style="color:#96b5b4;">source </span><span style="color:#c0c5ce;">&quot;$</span><span style="color:#bf616a;">ZZPATH</span><span style="color:#c0c5ce;">&quot;
</span></code></pre>
<p>Agora vamos verificar quantas linhas todos esses arquivos possuem juntos.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> wc</span><span style="color:#bf616a;"> -l</span><span style="color:#c0c5ce;"> .bashrc .bash_it/bash_it.sh /usr/local/bin/funcoeszz
    </span><span style="color:#bf616a;">80</span><span style="color:#c0c5ce;"> .bashrc
   </span><span style="color:#bf616a;">159</span><span style="color:#c0c5ce;"> .bash_it/bash_it.sh
 </span><span style="color:#bf616a;">20551</span><span style="color:#c0c5ce;"> /usr/local/bin/funcoeszz
 </span><span style="color:#bf616a;">20790</span><span style="color:#c0c5ce;"> total
</span></code></pre>
<p>Mais de 20 mil linhas. Então é sim possível que a mensagem de erro esteja em algum lugar entre elas. Mas são muitas linhas, e agora? Será que existe alguma forma de rastrear o processo de execução desse arquivo? A resposta é sim. Existe uma forma de coletar os passos de execução de um script linha por linha com uma opção do bash:<br />
<code>bash -x .nomedoscript.sh</code></p>
<p>Quando executei esse comando aqui. me retornou um monte de linhas no prompt. Para facilitar a vida, é possível redirecionar essa saída para outro arquivo. Vamos fazer isso com:</p>
<p><code>bash -x .bashrc 2&gt; log</code></p>
<p>Aqui nós redirecionamos as mensagens de erro para um novo arquivo chamado <em>log</em>. Agora é só buscarmos dentro desse arquivo aquilo que estiver em torno das linhas citadas lá no inicio. Vamos testar:</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#bf616a;">$</span><span style="color:#c0c5ce;"> cat</span><span style="color:#bf616a;"> -n</span><span style="color:#c0c5ce;"> log | </span><span style="color:#bf616a;">head -338 </span><span style="color:#c0c5ce;">| </span><span style="color:#bf616a;">tail -15 

   324</span><span style="color:#c0c5ce;">	++++ cut</span><span style="color:#bf616a;"> -d</span><span style="color:#c0c5ce;"> .</span><span style="color:#bf616a;"> -f</span><span style="color:#c0c5ce;"> 2
   </span><span style="color:#bf616a;">325</span><span style="color:#c0c5ce;">	+++ extension=aliases
   </span><span style="color:#bf616a;">326</span><span style="color:#c0c5ce;">	+++ BASH_IT_LOG_PREFIX=&#39;</span><span style="color:#a3be8c;">aliases: fuck: </span><span style="color:#c0c5ce;">&#39;
   </span><span style="color:#bf616a;">327</span><span style="color:#c0c5ce;">	+++ _log_debug &#39;</span><span style="color:#a3be8c;">Loading component...</span><span style="color:#c0c5ce;">&#39;
   </span><span style="color:#bf616a;">328</span><span style="color:#c0c5ce;">	+++ about &#39;</span><span style="color:#a3be8c;">log a debug message by echoing to the screen. needs BASH_IT_LOG_LEVEL &gt;= BASH_IT_LOG_LEVEL_ALL</span><span style="color:#c0c5ce;">&#39;
   </span><span style="color:#bf616a;">329</span><span style="color:#c0c5ce;">	+++ :
   </span><span style="color:#bf616a;">330</span><span style="color:#c0c5ce;">	+++ param &#39;</span><span style="color:#a3be8c;">1: message to log</span><span style="color:#c0c5ce;">&#39;
   </span><span style="color:#bf616a;">331</span><span style="color:#c0c5ce;">	+++ :
   </span><span style="color:#bf616a;">332</span><span style="color:#c0c5ce;">	+++ example &#39;</span><span style="color:#a3be8c;">$ _log_debug &quot;Loading plugin git...&quot;</span><span style="color:#c0c5ce;">&#39;
   </span><span style="color:#bf616a;">333</span><span style="color:#c0c5ce;">	+++ :
   </span><span style="color:#bf616a;">334</span><span style="color:#c0c5ce;">	+++ group log
   </span><span style="color:#bf616a;">335</span><span style="color:#c0c5ce;">	+++ :
   </span><span style="color:#bf616a;">336</span><span style="color:#c0c5ce;">	+++ </span><span style="color:#b48ead;">[</span><span style="color:#c0c5ce;">[ &#39;&#39; -ge 3 </span><span style="color:#b48ead;">]</span><span style="color:#c0c5ce;">]
   </span><span style="color:#bf616a;">337</span><span style="color:#c0c5ce;">	+++ return 0
   </span><span style="color:#bf616a;">338</span><span style="color:#c0c5ce;">	+++ source /home/romulo/.bash_it/enabled/150---fuck.aliases.bash
</span></code></pre>
<blockquote>
<p><strong>Cat</strong> com a opção <strong>-n</strong> enumera tudo que estiver em <strong>log</strong> linha por linha. E com um <em>pipe</em> <code>|</code> podemos redirecionar a saída do <strong>cat</strong> para o <strong>head</strong> que nos retorna apenas as primeiras linhas que estiverem seguidas do hífen <code>-338</code>. Com mais um <strong>pipe</strong> redirecionamos tudo que for retornado até agora para o <strong>tail</strong> que nos retorna apenas as últimas linhas também definidas com um hífen <code>-15</code>.</p>
</blockquote>
<p>De acordo com esse trecho, dá pra ver que meu problema está relacionado com uma condição que faz uma avaliação numérica com uma string vazia <code>[[ '' -ge 3 ]]</code>. Também podemos observar que o trecho do código está relacionado com um plugin chamado <em>BASH_IT</em>. </p>
<p>Depois de desinstalar o plugin meu terminal voltou ao normal. E aprendi que o bash já está cheio de recursos que nos ajudam a resolver nossos problemas no terminal. Basta dar uma olhada no manual do Bash. </p>

    </div>
</article>



    </div>
<script src="/livereload.js?port=1024&amp;mindelay=10"></script></body>
</html>
